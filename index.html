<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>CreatorCore AI Demo</title>
  <script async src="https://tally.so/widgets/embed.js"></script>
  <style>
    body { font-family: sans-serif; padding: 2rem; background: #f9f9f9; }
    nav { text-align: center; margin-bottom: 1rem; }
    img.logo { max-width: 200px; display: block; margin: 0 auto 1rem; }
    .container {
      max-width: 600px; margin: auto; background: #fff; padding: 2rem;
      border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      margin-bottom: 2rem;
    }
    label { font-weight: bold; margin-top: 1rem; display: block; }
    select, input, button, pre {
      display: block; width: 100%; margin: .5rem 0; padding: .5rem;
      border: 1px solid #ddd; border-radius: 4px;
    }
    button { background: #0066ff; color: #fff; border: none; cursor: pointer; }
    pre { background: #f0f0f0; white-space: pre-wrap; min-height: 3em; padding: 1rem; }
    .section-label { font-weight: bold; margin-top:1em; }
  </style>
</head>
<body>

  <!-- Logo & Banner -->
  <img class="logo" src="logo.png" alt="CreatorCore AI Logo"/>
  <img src="banner.png" alt="CreatorCore AI Banner"/>

  <!-- Nav -->
  <nav>
    <a href="index.html">Demo</a> | <a href="pricing.html">Pricing</a>
  </nav>

  <!-- HookBrain (unchanged) -->
  <div class="container">
    <h2>Hook Brain (All-In-One Content)</h2>
    <!-- inputs omitted for brevity… -->
  </div>

  <!-- CourseForge Module -->
  <div class="container">
    <h2>Course Forge (High-Ticket Course Builder)</h2>

    <label for="cfTopic">Course Topic</label>
    <select id="cfTopic">
      <option disabled selected>Select a topic…</option>
      <option>Mindset Mastery</option><option>Time Management</option>
      <!-- etc… -->
    </select>

    <label for="cfAudience">Audience</label>
    <select id="cfAudience">
      <option disabled selected>Select an audience…</option>
      <option>Busy Professionals</option><!-- etc… -->
    </select>

    <label for="cfFormat">Format</label>
    <select id="cfFormat">
      <option disabled selected>Select format…</option>
      <option>Video Course</option><!-- etc… -->
    </select>

    <label for="cfLevel">Skill Level</label>
    <select id="cfLevel">
      <option disabled selected>Select level…</option>
      <option>Beginner</option><!-- etc… -->
    </select>

    <button id="generateCourse">Generate Course</button>
    <div id="courseOutput">
      <pre>Your complete course package will appear here…</pre>
    </div>
    <button onclick="location='pricing.html'">Upgrade or View Plans</button>
  </div>

  <script>
  document.addEventListener("DOMContentLoaded", () => {
    // assume currentUser, getPlan(), postData() are defined above…

    // CourseForge button
    document.getElementById("generateCourse").addEventListener("click", async () => {
      const payload = {
        topic:    document.getElementById("cfTopic").value,
        audience: document.getElementById("cfAudience").value,
        format:   document.getElementById("cfFormat").value,
        level:    document.getElementById("cfLevel").value
      };
      const outputDiv = document.getElementById("courseOutput");
      outputDiv.innerHTML = "<pre>Generating course…</pre>";

      try {
        const { courseMarkdown } = await postData(
          "https://creatorcore-api.vercel.app/api/courseforge",
          payload
        );

        // Split into sections by "## "
        const parts = courseMarkdown.split("\n## ").map((part, i) => {
          if (i===0 && part.startsWith("## ")) part = part.slice(3);
          return part.trim();
        });

        // Build HTML
        const htmlSections = parts.map(raw => {
          const [heading, ...rest] = raw.split("\n");
          const body = rest.join("\n");
          // Determine label from heading
          const label = heading;
          // Convert lists & linebreaks to HTML
          const htmlBody = body
            .replace(/^- (.+)$/gm, "• $1")      // convert "- " to bullet
            .replace(/\n/g, "<br/>");          // line breaks
          return `<div>
            <div class="section-label">${label}</div>
            <div>${htmlBody}</div>
          </div>`;
        });

        outputDiv.innerHTML = htmlSections.join("<hr/>");

      } catch (err) {
        outputDiv.innerHTML = `<pre>Error: ${err.message}</pre>`;
      }
    });
  });
  </script>
</body>
</html>
