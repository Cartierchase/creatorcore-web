<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>CreatorCore AI Demo</title>
  <script async src="https://tally.so/widgets/embed.js"></script>
  <style>
    body { font-family:sans-serif; padding:2rem; background:#f9f9f9 }
    nav { text-align:center; margin-bottom:1rem }
    img.logo { max-width:200px; display:block; margin:0 auto 1rem }
    .container {
      max-width:600px; margin:auto; background:#fff; padding:2rem;
      border-radius:8px; box-shadow:0 4px 12px rgba(0,0,0,0.1); margin-bottom:2rem
    }
    input, select, button, pre {
      display:block; width:100%; margin:.5rem 0; padding:.5rem;
      border:1px solid #ddd; border-radius:4px
    }
    button { background:#0066ff; color:#fff; border:none; cursor:pointer }
    pre { background:#f0f0f0; white-space:pre-wrap; min-height:3em }
    #planSelector { display:none; margin-bottom:1rem }
  </style>
</head>
<body>

  <!-- Logo & Banner -->
  <img class="logo" src="logo.png" alt="CreatorCore AI Logo"/>
  <img src="banner.png" alt="CreatorCore AI Banner"/>

  <!-- Nav -->
  <nav>
    <a href="index.html">Demo</a> |
    <a href="pricing.html">Pricing</a>
  </nav>

  <!-- Dev Mode Plan Selector -->
  <div id="planSelector" class="container">
    <label><strong>DEV MODE: Your Plan</strong></label>
    <select id="userPlan">
      <option value="free">Free (3 captions/day, 1 course/month)</option>
      <option value="creator">Creator ($29/mo: unlimited captions, 3 blueprints)</option>
      <option value="pro">Pro ($99/mo: unlimited + batching + funnel writer)</option>
      <option value="lifetime">Lifetime ($497 one-time)</option>
    </select>
  </div>

  <!-- Hook Brain Module -->
  <div class="container">
    <h2>Hook Brain (All-In-One)</h2>

    <label for="niche">Niche</label>
    <select id="niche">
      <option disabled selected>Choose a niche…</option>
      <option>Fitness</option><option>Beauty</option><option>Travel</option>
      <option>Food</option><option>Finance</option><option>Tech</option>
      <option>Parenting</option><option>Fashion</option><option>Gaming</option>
      <option>Wellness</option>
    </select>

    <label for="tone">Tone</label>
    <select id="tone">
      <option disabled selected>Choose a tone…</option>
      <option>Inspirational</option><option>Motivational</option>
      <option>Humorous</option><option>Authentic</option>
      <option>Edgy</option><option>Warm</option>
      <option>Educational</option><option>Confessional</option>
    </select>

    <label for="goal">Goal</label>
    <select id="goal">
      <option disabled selected>Choose a goal…</option>
      <option>Engagement</option><option>Followers</option>
      <option>Brand Awareness</option><option>Leads</option>
      <option>Sales</option><option>Community Building</option>
    </select>

    <label for="topic">Topic</label>
    <input id="topic" placeholder="Specific topic (e.g. Meal Prepping)"/>

    <label for="postType">Post Type</label>
    <select id="postType">
      <option disabled selected>Select post type…</option>
      <option>Instagram</option><option>TikTok</option>
      <option>Reels</option><option>YouTube</option>
      <option>Shorts</option>
    </select>

    <button id="generateCaptions">Generate All Content</button>
    <pre id="hookbrainOutput">All generated content will appear here…</pre>
    <button onclick="location='pricing.html'">Upgrade or View Plans</button>
  </div>

  <script>
  document.addEventListener("DOMContentLoaded", () => {
    // Load stored user & plan
    const storedEmail = localStorage.getItem("cc_user") || "";
    const storedPlan  = localStorage.getItem("cc_plan") || "free";
    window.currentUser = { email:storedEmail, plan:storedPlan };

    // Dev-mode detection
    const DEV_USER_IDS = ["you@yourdomain.com"];
    const isDev = DEV_USER_IDS.includes(storedEmail) || location.search.includes("dev=true");
    if (isDev) {
      document.getElementById("planSelector").style.display = "block";
      document.getElementById("userPlan").value = storedPlan;
    }

    // Helper to get plan
    function getPlan(){
      return isDev
        ? document.getElementById("userPlan").value
        : window.currentUser.plan;
    }

    // Robust postData
    async function postData(url, body){
      const headers = {
        "Content-Type":"application/json",
        "X-User-Plan": getPlan(),
        "X-User-Id":   window.currentUser.email
      };
      const res = await fetch(url, { method:"POST", headers, body:JSON.stringify(body) });
      const text = await res.text();
      if (!res.ok){
        let msg;
        try{ msg = JSON.parse(text).error } catch{ msg = text }
        throw new Error(msg||`HTTP ${res.status}`);
      }
      return JSON.parse(text);
    }

    // Generate content
    document.getElementById("generateCaptions").addEventListener("click", async () => {
      const payload = {
        niche:    document.getElementById("niche").value,
        tone:     document.getElementById("tone").value,
        goal:     document.getElementById("goal").value,
        topic:    document.getElementById("topic").value,
        postType: document.getElementById("postType").value
      };
      try {
        const d = await postData("https://creatorcore-api.vercel.app/api/hookbrain", payload);
        const out = [
          "**Captions:**\n" + (d.captions||[]).join("\n\n"),
          "**Script:**\n"   + (d.script   || ""),
          "**Idea:**\n"     + (d.idea     || ""),
          "**SEO & Hashtags:**\n" + (d.seo||[]).join(", ")
        ].join("\n\n— — —\n\n");
        document.getElementById("hookbrainOutput").textContent = out;
      } catch(err){
        document.getElementById("hookbrainOutput").textContent = "Error: "+err.message;
      }
    });
  });
  </script>
</body>
</html>
