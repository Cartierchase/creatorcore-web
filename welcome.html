<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Activate CreatorCore AI</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; background: #f9f9f9; }
    .box { max-width: 400px; margin: auto; background: #fff; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    input, button { display: block; width: 100%; padding: .75rem; margin: 1rem 0; border: 1px solid #ccc; border-radius: 4px; }
    button { background: #0066ff; color: #fff; border: none; cursor: pointer; }
  </style>
</head>
<body>
  <div class="box">
    <h1>Welcome to CreatorCore AI!</h1>
    <p>Enter the email you used to purchase:</p>
    <input id="email" type="email" placeholder="you@example.com" />
    <button id="login">Continue</button>
    <p id="message" style="color:#c00; font-size:.9rem;"></p>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const emailInput = document.getElementById("email");
      const loginBtn   = document.getElementById("login");
      const msg        = document.getElementById("message");

      loginBtn.addEventListener("click", async () => {
        const email = emailInput.value.trim();
        if (!email) {
          msg.textContent = "Please enter a valid email address.";
          return;
        }

        try {
          const res = await fetch(
            "https://creatorcore-api.vercel.app/api/getPlan",
            {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ email })
            }
          );
          const { plan, error } = await res.json();
          if (error || !plan) {
            msg.textContent = "No active plan found for this email.";
            return;
          }

          // persist and redirect
          localStorage.setItem("cc_user", email);
          localStorage.setItem("cc_plan", plan);
          window.location.href = "index.html";
        } catch (e) {
          console.error(e);
          msg.textContent = "Network errorâ€”please try again.";
        }
      });
    });
  </script>
</body>
</html>
